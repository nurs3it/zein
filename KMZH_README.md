# КМЖ - Календарно-тематическое планирование

## Описание

Модуль КМЖ (Календарно-тематическое планирование) - это система для управления учебными планами в образовательных учреждениях. Модуль позволяет создавать, редактировать и отслеживать как краткосрочные (на день/неделю), так и долгосрочные (на четверть/год) планы обучения.

## Архитектура

Модуль построен по принципу Feature-Sliced Design (FSD) и включает:

### Entities (Сущности)

- **`src/entities/term-plan/`** - основные сущности системы
  - `model/types.ts` - типы данных для планов, предметов, задач
  - `api/term-plan-api.ts` - API клиент для взаимодействия с бэкендом

### Features (Функциональность)

- **`src/features/term-plan/`** - бизнес-логика модуля
  - `model/term-plan-slice.ts` - Redux slice для управления состоянием
  - `model/term-plan-hooks.ts` - React Query хуки для работы с API

### Pages (Страницы)

- **`src/app/platform/kmzh/`** - страницы модуля
  - `page.tsx` - главная страница с обзором и навигацией
  - `short-term/page.tsx` - управление краткосрочными планами
  - `long-term/page.tsx` - управление долгосрочными планами
  - `subjects/page.tsx` - управление предметами
  - `stats/page.tsx` - статистика и аналитика
  - `settings/page.tsx` - настройки системы

## Основные возможности

### 1. Краткосрочные планы

- Создание планов уроков на день/неделю
- Указание темы, целей, предмета, класса
- Настройка целей обучения
- Добавление теоретического материала
- Системные промпты для ИИ

### 2. Долгосрочные планы

- Планирование на четверть/год
- Управление статусами (активный/неактивный, завершен/в процессе)
- Привязка к учебному году и четверти

### 3. Управление предметами

- Создание и редактирование предметов
- Многоязычность (казахский, русский, английский)
- Категоризация по типам (гуманитарные, технические, естественные науки и т.д.)

### 4. Статистика и аналитика

- Общая статистика по планам
- Статусы выполнения
- Эффективность планирования
- Экспорт отчетов

### 5. Настройки системы

- Язык интерфейса
- Тема оформления
- Настройки API
- Уведомления
- Безопасность
- Интернационализация

## API интеграция

Модуль интегрирован с API по адресу `http://oneki.kz:8002/api` и поддерживает следующие эндпоинты:

### Краткосрочные планы

- `GET /term-plan/short-term-plans/` - список планов
- `POST /term-plan/short-term-plans/` - создание плана
- `GET /term-plan/short-term-plans/{id}/` - получение плана
- `PATCH /term-plan/short-term-plans/{id}/` - обновление плана
- `DELETE /term-plan/short-term-plans/{id}/` - удаление плана

### Долгосрочные планы

- `GET /term-plan/long-term-plans/` - список планов
- `POST /term-plan/long-term-plans/` - создание плана
- `GET /term-plan/long-term-plans/{id}/` - получение плана
- `PATCH /term-plan/long-term-plans/{id}/` - обновление плана
- `DELETE /term-plan/long-term-plans/{id}/` - удаление плана

### Предметы

- `GET /term-plan/subjects/` - список предметов
- `POST /term-plan/subjects/` - создание предмета
- `GET /term-plan/subjects/{id}/` - получение предмета
- `PATCH /term-plan/subjects/{id}/` - обновление предмета
- `DELETE /term-plan/subjects/{id}/` - удаление предмета

### Статистика

- `GET /term-plan/stats/` - общая статистика

## Технологии

- **Frontend**: Next.js 14, React 18, TypeScript
- **State Management**: Redux Toolkit, React Query
- **UI**: Tailwind CSS, Lucide React Icons
- **HTTP Client**: Axios
- **Architecture**: Feature-Sliced Design (FSD)

## Структура данных

### ShortTermPlan (Краткосрочный план)

```typescript
interface ShortTermPlan {
  id: number;
  lesson_topic: string;
  lesson_goal: string;
  class_number: number;
  subject: string;
  subject_type: SubjectTypeEnum;
  learning_objectives: string[];
  theory: string;
  status: ShortTermPlanStatusEnum;
  lang: LangEnum;
  // ... другие поля
}
```

### LongTermPlan (Долгосрочный план)

```typescript
interface LongTermPlan {
  id: number;
  title: string;
  description: string;
  academic_year: string;
  quarter: number;
  subject: string;
  subject_type: SubjectTypeEnum;
  is_active: boolean;
  is_completed: boolean;
  // ... другие поля
}
```

### Subject (Предмет)

```typescript
interface Subject {
  id: number;
  title_kk: string;
  title_ru: string;
  title_en: string;
  // ... другие поля
}
```

## Использование

### Навигация

Модуль доступен через главное меню платформы по пункту "КМЖ" и содержит следующие разделы:

1. **Обзор** - главная страница с статистикой и быстрым доступом
2. **Краткосрочные планы** - управление планами уроков
3. **Долгосрочные планы** - планирование на четверть/год
4. **Предметы** - управление предметами и направлениями
5. **Статистика** - аналитика и отчеты
6. **Настройки** - конфигурация системы

### Создание плана

1. Перейти в раздел "Краткосрочные планы" или "Долгосрочные планы"
2. Нажать кнопку "Создать план"
3. Заполнить форму с обязательными полями
4. Сохранить план

### Фильтрация и поиск

- Поиск по названию/теме
- Фильтрация по статусу
- Фильтрация по типу предмета
- Фильтрация по классу
- Фильтрация по активности/завершенности

## Разработка

### Добавление новых функций

1. Создать типы в `entities/term-plan/model/types.ts`
2. Добавить API методы в `entities/term-plan/api/term-plan-api.ts`
3. Создать Redux actions в `features/term-plan/model/term-plan-slice.ts`
4. Добавить хуки в `features/term-plan/model/term-plan-hooks.ts`
5. Создать UI компоненты и страницы

### Тестирование

- Проверить работу всех CRUD операций
- Протестировать фильтрацию и поиск
- Убедиться в корректности валидации форм
- Проверить адаптивность на разных устройствах

## Деплой

Модуль автоматически включается в основное приложение при сборке. Для продакшена используется прокси-сервер для решения проблем с Mixed Content.

## Поддержка

При возникновении проблем:

1. Проверить консоль браузера на наличие ошибок
2. Убедиться в доступности API
3. Проверить корректность токенов авторизации
4. Обратиться к логам сервера

## Планы развития

- [ ] Интеграция с календарем
- [ ] Экспорт в различные форматы (PDF, Excel)
- [ ] Шаблоны планов
- [ ] Совместное планирование
- [ ] Мобильное приложение
- [ ] Интеграция с LMS системами
